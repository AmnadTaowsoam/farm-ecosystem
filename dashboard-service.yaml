openapi: 3.0.3
info:
  title: Dashboard Service API
  version: "1.0.0"
  description: API สำหรับจัดการข้อมูลสรุป KPI และการตั้งค่า Dashboard ของระบบ Smart Farming

servers:
  - url: https://api.yourdomain.com/dashboard
    description: Production server

security:
  - bearerAuth: []

paths:
  /{user_id}/config:
    get:
      summary: ดึงการตั้งค่า dashboard ของผู้ใช้
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: รหัสผู้ใช้
      responses:
        '200':
          description: การตั้งค่า dashboard
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    type: object
                    description: การตั้งค่า dashboard ในรูปแบบ JSON
                    example:
                      theme: "dark"
                      widgets:
                        - "kpi_summary"
                        - "temperature_chart"
        '404':
          description: ไม่พบการตั้งค่าสำหรับผู้ใช้นี้
        '401':
          description: Unauthorized
      security:
        - bearerAuth: []

    post:
      summary: บันทึกการตั้งค่า dashboard ของผู้ใช้
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: รหัสผู้ใช้
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                config:
                  type: object
                  description: การตั้งค่า dashboard ในรูปแบบ JSON
                  example:
                    theme: "dark"
                    widgets:
                      - "kpi_summary"
                      - "temperature_chart"
      responses:
        '200':
          description: บันทึกการตั้งค่า dashboard สำเร็จ
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    type: object
                    description: การตั้งค่า dashboard ในรูปแบบ JSON
        '400':
          description: ข้อมูลไม่ถูกต้อง
        '401':
          description: Unauthorized
      security:
        - bearerAuth: []

  /{farm_id}/metrics:
    get:
      summary: ดึง KPI metrics สรุปสำหรับฟาร์ม
      parameters:
        - name: farm_id
          in: path
          required: true
          schema:
            type: integer
          description: รหัสฟาร์ม
        - name: date_range_start
          in: query
          schema:
            type: string
            format: date
          description: วันที่เริ่มต้นของช่วงเวลาที่ต้องการดูข้อมูล (YYYY-MM-DD)
        - name: date_range_end
          in: query
          schema:
            type: string
            format: date
          description: วันที่สิ้นสุดของช่วงเวลาที่ต้องการดูข้อมูล (YYYY-MM-DD)
      responses:
        '200':
          description: รายการ KPI metrics สรุป
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    metric_name:
                      type: string
                      example: "Average Temperature"
                    metric_value:
                      type: number
                      example: 27.5
                    metric_date:
                      type: string
                      format: date
                      example: "2025-06-12"
        '404':
          description: ไม่พบข้อมูลสำหรับฟาร์มนี้
        '401':
          description: Unauthorized
      security:
        - bearerAuth: []

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
